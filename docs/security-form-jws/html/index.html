<!DOCTYPE html>
<html lang="en">
    <head><!-- Google tag (gtag.js) -->
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-GQCEQ9P38V"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-GQCEQ9P38V');
        </script>
        <meta charset="UTF-8" />
        <title>The Inverno Framework | Web Application Security Guide</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="author" content="Jeremy KUHN (jeremy.kuhn@inverno.io)" />
        <link rel="icon" type="image/svg" href="../../../img/snowflake.svg" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />
        <link rel="stylesheet" type="text/css" href="../../../styles/styles.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/stackoverflow-dark.min.css" media="screen" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/ascetic.min.css" media="print" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </head>
    <body data-bs-spy="scroll" data-bs-target="#toc" data-bs-offset="0" tabindex="0">
        <header class="header">
            <div class="container-fluid border-bottom bg-light">
                <nav class="navbar navbar-expand-lg navbar-light container p-0 py-2 p-lg-1"><a class="navbar-brand p-0" href="../../../"> <img class="logo" src="../../../img/inverno_portable.svg" alt="The Inverno Framework" /> </a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#smallNavMenu" aria-controls="smallNavMenu" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
                    <div class="collapse" id="smallNavMenu" style="flex-basis: 100%;">
                        <ul class="navbar-nav navbar-nav-scroll border-top" style="max-height: calc(100vh - 3.75rem);">
                            <li class="nav-item mt-2"><h5>Documentation</h5>
                              <ul class="nav flex-column">
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/release/reference/html/index.html">Reference Guide</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/release/api/index.html">API Doc</a></li>
                              <li>
                              <hr class="dropdown-divider" /></li>
                              <li><h6 class="dropdown-header">User guides</h6></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/getting-started/html/index.html">Getting Started</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/redis-vue3-fullstack/html/index.html">Build a Full-Stack application</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/security-form-jws/html/index.html">Secure a Web application</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/security-rbac/html/index.html">Role-based Access Control</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/security-pbac/html/index.html">Permission-based Access Control</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="../../../docs/security-ldap/html/index.html">LDAP Security</a></li>
                              </ul></li>
                            <li class="nav-item mt-2"><h5>Projects</h5>
                              <ul class="nav flex-column">
                              <li class="nav-item ms-4"><a class="nav-link" href="https://github.com/inverno-io/inverno-core">Core</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="https://github.com/inverno-io/inverno-mods">Modules</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="https://github.com/inverno-io/inverno-dist">Distribution</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="https://github.com/inverno-io/inverno-tools">Tools</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="https://github.com/inverno-io/inverno-examples">Examples</a></li>
                              <li class="nav-item ms-4"><a class="nav-link" href="https://github.com/inverno-io/inverno-apps">Apps</a></li>
                              </ul></li>
                            <li class="nav-item mt-2"><a class="btn btn-outline-secondary" href="https://github.com/sponsors/inverno-io?o=esb" id="sponsor" role="button" aria-label="Sponsor @inverno-io" target="_top"><i class="bi bi-heart-fill"></i> Sponsor</a></li>
                        </ul>
                    </div>
                    <ul class="navbar-nav d-none d-sm-none d-lg-flex flex-fill justify-content-end align-self-stretch">
                        <li class="nav-item dropdown d-flex align-items-center me-3"><a class="nav-link dropdown-toggle text-decoration-none" href="#" id="documentationMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false">Documentation</a>
                            <ul class="dropdown-menu mt-1 border-0 shadow p-3 mb-5 bg-body rounded" aria-labelledby="documentationMenu">
                              <li><a class="dropdown-item" href="../../../docs/release/reference/html/index.html">Reference Guide</a></li>
                              <li><a class="dropdown-item" href="../../../docs/release/api/index.html">API Doc</a></li>
                              <li>
                              <hr class="dropdown-divider" /></li>
                              <li><h6 class="dropdown-header">User guides</h6></li>
                              <li><a class="dropdown-item" href="../../../docs/getting-started/html/index.html">Getting Started</a></li>
                              <li><a class="dropdown-item" href="../../../docs/redis-vue3-fullstack/html/index.html">Build a Full-Stack application</a></li>
                              <li><a class="dropdown-item" href="../../../docs/security-form-jws/html/index.html">Secure a Web application</a></li>
                              <li><a class="dropdown-item" href="../../../docs/security-rbac/html/index.html">Role-based Access Control</a></li>
                              <li><a class="dropdown-item" href="../../../docs/security-pbac/html/index.html">Permission-based Access Control</a></li>
                              <li><a class="dropdown-item" href="../../../docs/security-ldap/html/index.html">LDAP Security</a></li>
                            </ul></li>
                        <li class="nav-item dropdown d-flex align-items-center me-3"><a class="nav-link dropdown-toggle text-decoration-none" href="#" id="projectsMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false">Projects</a>
                            <ul class="dropdown-menu mt-1 border-0 shadow p-3 mb-5 bg-body rounded" aria-labelledby="projectsMenu">
                              <li><a class="dropdown-item" href="https://github.com/inverno-io/inverno-core">Core</a></li>
                              <li><a class="dropdown-item" href="https://github.com/inverno-io/inverno-mods">Modules</a></li>
                              <li><a class="dropdown-item" href="https://github.com/inverno-io/inverno-dist">Distribution</a></li>
                              <li><a class="dropdown-item" href="https://github.com/inverno-io/inverno-tools">Tools</a></li>
                              <li><a class="dropdown-item" href="https://github.com/inverno-io/inverno-examples">Examples</a></li>
                              <li><a class="dropdown-item" href="https://github.com/inverno-io/inverno-apps">Apps</a></li>
                            </ul></li>
                        <li class="nav-item d-flex align-items-center"><a class="btn btn-outline-secondary" href="https://github.com/sponsors/inverno-io?o=esb" id="sponsor" role="button" aria-label="Sponsor @inverno-io" target="_top"><i class="bi bi-heart-fill"></i> Sponsor</a></li>
                    </ul>
                </nav>
            </div>
        </header>
        <main id="main" class="main container">
            <div class="heading">
                <h1 class="heading-title">Inverno Framework Web Application Security Guide</h1>
                <p class="heading-subtitle">Author: <a href="mailto:jeremy.kuhn@inverno.io">Jeremy Kuhn</a></p>
            </div>
            <div class="row align-items-stretch mt-5 mb-2">
                <div class="col-12 col-lg-6 mb-3">
                    <div class="card shadow h-100">
                        <div class="card-body p-lg-5">
                            <h2 class="card-title">What you'll learn</h2>
                            <p class="card-text">This guide shows how to secure access to an Inverno Web application.</p>
                            <p class="card-text">We will guide you through setting up a form-based login in an Inverno Web application using a <a href="https://redis.io">Redis</a> user repository.</p>
                            <p class="card-text">On successful login, a <a href="https://datatracker.ietf.org/doc/html/rfc7515">JSON Web Signature</a> token will be generated and returned to the Web browser in a cookie, this token will then be used to access protected services and resources.</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-6 mb-3">
                    <div class="card shadow h-100">
                        <div class="card-body p-lg-5">
                            <h2 class="card-title">What you'll need</h2>
                            <ul>
                              <li>A <em>Javaâ„¢ Development Kit</em> (<a href="https://openjdk.java.net/install/">OpenJDK</a>) at least version 16.</li>
                              <li>Apache <a href="https://maven.apache.org/">Maven</a> at least version 3.6.</li>
                              <li>An <em>Integrated Development Environment</em> (IDE) such as <a href="https://www.eclipse.org/">Eclipse</a> or <a href="https://www.jetbrains.com/idea/">IDEA</a> although any text editor will do.</li>
                              <li>An Inverno Web application to secure, such as the <a href="https://github.com/inverno-io/inverno-apps/tree/1.2.0/inverno-ticket">Inverno Ticket</a> application you should have created when you followed the <a href="../../../docs/redis-vue3-fullstack/html/index.html">Inverno Framework Full-Stack application Guide</a>.</li>
                              <li>A basic understanding of Redis data store.</li>
                              <li>A basic understanding of Inverno's Web application development (see web module documentation in the <a href="../../../docs/release/reference/html/index/html">Reference documentation</a>).</li>
                              <li>A basic understanding of JSON Object Signing and Encryption concepts.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <section class="markdown col p-3 overflow-auto">
                <p>This guide directly follows the <a href="../../../docs/redis-vue3-fullstack/html/index.html">Inverno Framework Full-Stack application Guide</a>. In this guide you will secure the Inverno Ticket application that was created then.</p>
                <p>The objective is to protect the access to every services or resources exposed in the application by requiring an authentication. Since you clearly don't want to ask a user to manually enter credentials each time a service or a resource is accessed, authentication will be done in two steps: first a user will have to authenticate on a login page by providing proper credentials (username/password) submitted in a form to a login action which then returns a token to the client (Web browser) sent in every subsequent requests to the application.</p>
                <p>The login action will authenticate login credentials against a <a href="https://redis.io">Redis</a> user repository. A redis data store should already be configured in the Ticket application making things easier.</p>
                <p>The token will be a <a href="https://datatracker.ietf.org/doc/html/rfc7515">JSON Web Signature</a> object that can be easily authenticated by validating a digital signature. This token can be seen as a visitor badge that one would have obtained form a security desk at the entrance of building after showing proper credentials (e.g. ID card...).</p>
                <p>The complete Inverno Ticket application can be found in <a href="https://github.com/inverno-io/inverno-apps/tree/1.2.0/inverno-ticket">GitHub</a>.</p>
                <h2 id="step-1-declare-inverno-security-dependencies">Step 1: Declare Inverno security dependencies</h2>
                <p>The first thing to do is to add dependencies to Inverno security modules. In order to secure a Web application using form-based login and a JWS token you basically need to add dependencies to Inverno <em>security-http</em> module, which provides services to secure Web applications, and to Inverno <em>securiy-jose</em> module, which provides services for creating and validating JWS, JWE or JWT tokens.</p>
                <p>These dependencies should be first added to the <code>pom.xml</code> build descriptor of the project:</p>
                <pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;io.inverno.dist&lt;/groupId&gt;
        &lt;artifactId&gt;inverno-parent&lt;/artifactId&gt;
        &lt;version&gt;1.6.0&lt;/version&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;io.inverno.guide&lt;/groupId&gt;
    &lt;artifactId&gt;ticket&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;dependencies&gt;
        ...
        &lt;dependency&gt;
            &lt;groupId&gt;io.inverno.mod&lt;/groupId&gt;
            &lt;artifactId&gt;inverno-security-http&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.inverno.mod&lt;/groupId&gt;
            &lt;artifactId&gt;inverno-security-jose&lt;/artifactId&gt;
        &lt;/dependency&gt;
        ...
    &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre>
                <p>You can now add dependencies to <code>io.inverno.mod.security.http</code> and <code>io.inverno.mod.security.jose</code> modules in the <code>module-info.java</code> descriptor.</p>
                <pre><code class="language-java">@io.inverno.core.annotation.Module
module io.inverno.guide.ticket {
    ...
    requires io.inverno.mod.security.http;
    requires io.inverno.mod.security.jose;
    ...
}
</code></pre>
                <p>You should now be all set and you can start securing the application.</p>
                <blockquote>
                    <p>Note that the Inverno <em>security</em> module, which defines core security API and services, is provided as a transitive dependency.</p>
                </blockquote>
                <h2 id="step-2-setup-the-login-page">Step 2: Setup the Login page</h2>
                <p>Let's start by setting up the application login page that will be used by users to log into the application. The Inverno <em>security-http</em> module provides a whitelabel login page through the <code>FormLoginPageHandler</code>, it contains a simple login form which allows users to submit login credentials (username/password) to the login action.</p>
                <p>The login action is implemented in the <code>LoginActionHandler</code> which basically authenticates the submitted credentials using a <code>FormCredentialsExtractor</code> to extract <code>LoginCredentials</code> from the request and an <code>Authenticator</code> capable of authenticating <code>LoginCredentials</code>. Users credentials will be authenticated against a Redis user repository, as a result a <code>UserAuthenticator</code> backed by a <code>RedisUserRepository</code> shall be used. Since the <code>User</code> stored in the repository can also provide identity information, <code>PersonIdentity</code> information will also be stored and exposed in order to be used later in the application whenever there is a need for identification.</p>
                <p>On successful authentication, a <a href="https://datatracker.ietf.org/doc/html/rfc7515">JSON Web Signature</a> object wrapping the resulting <code>UserAuthentication&lt;PersonIdentity&gt;</code> should be created and returned in a cookie to the Web browser.</p>
                <p>You can start by creating bean <code>UserRepositoryWrapper</code> to expose the <code>RedisUserRepository</code>. This will abstract the actual user repository from the user authenticator and ease maintenance if the <code>UserRepository</code> implementation must be changed at some point. A <code>RedisUserRepository</code> requires a <code>RedisClient</code> and an <code>ObjectMapper</code> which should already be provided in the application by the <em>redis</em> and the <em>boot</em> modules respectively.</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

import com.fasterxml.jackson.databind.ObjectMapper;
import io.inverno.core.annotation.Bean;
import io.inverno.core.annotation.Wrapper;
import io.inverno.mod.redis.RedisClient;
import io.inverno.mod.security.authentication.user.RedisUserRepository;
import io.inverno.mod.security.authentication.user.User;
import io.inverno.mod.security.authentication.user.UserRepository;
import io.inverno.mod.security.identity.PersonIdentity;
import java.util.function.Supplier;

@Wrapper @Bean( name = "userRepository" )
public class UserRepositoryWrapper implements Supplier&lt;UserRepository&lt;PersonIdentity, User&lt;PersonIdentity&gt;&gt;&gt; {

    private final RedisClient&lt;String, String&gt; redisClient;
    private final ObjectMapper mapper;

    public UserRepositoryWrapper(RedisClient&lt;String, String&gt; redisClient, ObjectMapper mapper) {
        this.redisClient = redisClient;
        this.mapper = mapper;
    }

    @Override
    public UserRepository&lt;PersonIdentity, User&lt;PersonIdentity&gt;&gt; get() {
        return new RedisUserRepository&lt;&gt;(this.redisClient, this.mapper);
    }
}
</code></pre>
                <p>Now you need to define a JSON Web Key (JWK) for your application, this key will be used to create, parse and verify the JSON Web Signature tokens. The Inverno <em>security-jose</em> module provides the <code>JWKService</code> which can be used to generate a <code>JWK</code> or load it from the configuration. To keep things simple, let's assume a new key will be generated each time the application is started.</p>
                <p>The algorithm used to digitally sign JWS will be a simple symmetric algorithm, such as <code>HS512</code>. The <code>JWSService</code> that will be used to manipulate JWS objects has the ability to automatically look up keys by id from a <code>JWKStore</code>. So let's create an <code>InMemoryJWKStore</code> bean to store keys in memory and a trusted <code>JWK</code> bean registered into the <code>JWKStore</code>.</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

import io.inverno.core.annotation.Bean;
import io.inverno.core.annotation.Init;
import io.inverno.core.annotation.Wrapper;
import io.inverno.mod.security.jose.jwa.OCTAlgorithm;
import io.inverno.mod.security.jose.jwk.InMemoryJWKStore;
import io.inverno.mod.security.jose.jwk.JWK;
import io.inverno.mod.security.jose.jwk.JWKService;
import io.inverno.mod.security.jose.jwk.JWKStore;

import java.util.function.Supplier;

@Wrapper @Bean( name = "jwk" )
public class JWKWrapper implements Supplier&lt;JWK&gt; {

    private final JWKService jwkService;

    public JWKWrapper(JWKService jwkService) {
        this.jwkService = jwkService;
    }

    @Override
    public JWK get() {
        return this.jwkService.oct().generator()
            .keyId("tkt")
            .algorithm(OCTAlgorithm.HS512.getAlgorithm())
            .generate()
            .map(JWK::trust)
            .flatMap(jwk -&gt; jwkService.store().set(jwk).thenReturn(jwk))
            .block();
    }

    @Wrapper @Bean
    public static class JWKStoreWrapper implements Supplier&lt;JWKStore&gt; {

        @Override
        public JWKStore get() {
            return new InMemoryJWKStore();
        }
    }
}
</code></pre>
                <p>Note that the generated key must be explicitly trusted because a generated keys are not trusted by default. Untrusted keys cannot be used to create or verify JWS objects.</p>
                <blockquote>
                    <p>You may wonder why we had to create two beans and why not just the <code>JWKStore</code> bean with a <code>JWK</code> socket or an init method for initializing the JWK. The reason is actually quite simple, since the <code>JWKStore</code> is injected in the <code>JWKService</code>, it is not possible to create or inject the <code>JWK</code> in the <code>JWKStore</code> using the <code>JWKService</code> as this would lead to a cycle in the bean dependency graph.</p>
                </blockquote>
                <p>From there, it is quite simple to load a JWK from configuration, it only requires to use a <code>builder()</code> instead of a <code>generator()</code> and provide the symmetric key value in the configuration.</p>
                <p>You can now create the <code>SecurityConfigurer</code> bean that will be used to configure security for the whols application. For now, it shall implement <code>WebRoutesConfigurer</code> in order to define routes to the login page using the <code>FormLoginPageHandler</code> and the login action using the <code>LoginActionHandler</code>:</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

import io.inverno.mod.base.resource.MediaTypes;
import io.inverno.mod.http.base.Method;
import io.inverno.mod.security.accesscontrol.AccessController;
import io.inverno.mod.security.authentication.LoginCredentialsMatcher;
import io.inverno.mod.security.authentication.user.User;
import io.inverno.mod.security.authentication.user.UserAuthentication;
import io.inverno.mod.security.authentication.user.UserAuthenticator;
import io.inverno.mod.security.authentication.user.UserRepository;
import io.inverno.mod.security.http.context.SecurityContext;
import io.inverno.mod.security.http.form.FormCredentialsExtractor;
import io.inverno.mod.security.http.form.FormLoginPageHandler;
import io.inverno.mod.security.http.form.RedirectLoginFailureHandler;
import io.inverno.mod.security.http.form.RedirectLoginSuccessHandler;
import io.inverno.mod.security.http.login.LoginActionHandler;
import io.inverno.mod.security.http.login.LoginSuccessHandler;
import io.inverno.mod.security.http.token.CookieTokenLoginSuccessHandler;
import io.inverno.mod.security.identity.PersonIdentity;
import io.inverno.mod.security.jose.jwa.OCTAlgorithm;
import io.inverno.mod.security.jose.jws.JWSAuthentication;
import io.inverno.mod.security.jose.jws.JWSService;
import io.inverno.mod.web.WebRoutable;
import io.inverno.mod.web.WebRoutesConfigurer;

@WebRoutes({
    @WebRoute(path = { "/login" }, method = { Method.GET }),
    @WebRoute(path = { "/login" }, method = { Method.POST }),
})
@Bean( visibility = Bean.Visibility.PRIVATE )
public class SecurityConfigurer implements WebRoutesConfigurer&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;&gt; {

    private final UserRepository&lt;PersonIdentity, User&lt;PersonIdentity&gt;&gt; userRepository;
    private final JWSService jwsService;

    public SecurityConfigurer(UserRepository&lt;PersonIdentity, User&lt;PersonIdentity&gt;&gt; userRepository, JWSService jwsService) {
        this.userRepository = userRepository;
        this.jwsService = jwsService;
    }

    @Override
    public void configure(WebRoutable&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;, ?&gt; routes) {
        routes
            .route()                                                                                                                     // 1 
                .path("/login")
                .method(Method.GET)
                .handler(new FormLoginPageHandler&lt;&gt;())
            .route()                                                                                                                     // 2 
                .path("/login")
                .method(Method.POST)
                .handler(new LoginActionHandler&lt;&gt;(                                                                                       // 3 
                    new FormCredentialsExtractor(),                                                                                      // 4 
                    new UserAuthenticator&lt;&gt;(this.userRepository, new LoginCredentialsMatcher&lt;&gt;())                                        // 5 
                        .failOnDenied()                                                                                                  // 6 
                        .flatMap(authentication -&gt; this.jwsService.&lt;UserAuthentication&lt;PersonIdentity&gt;&gt;builder(UserAuthentication.class) // 7 
                            .header(header -&gt; header
                                .keyId("tkt")
                                .algorithm(OCTAlgorithm.HS512.getAlgorithm())
                            )
                            .payload(authentication)
                            .build(MediaTypes.APPLICATION_JSON)
                            .map(JWSAuthentication::new)
                        ),
                    LoginSuccessHandler.of(                                                                                              // 8 
                        new CookieTokenLoginSuccessHandler&lt;&gt;(),
                        new RedirectLoginSuccessHandler&lt;&gt;()
                    ),
                    new RedirectLoginFailureHandler&lt;&gt;()                                                                                  // 9 
                ));
    }
}
</code></pre>
                <p>Above configurer deserves some deeper explanations:</p>
                <ol>
                    <li>The <code>GET /login</code> web route is declared to serve the whitelabel login page using the <code>FormLoginPageHandler</code>.</li>
                    <li>The <code>POST /login</code> web route is declared to process the login action, it is basically targeted by the form in the login page.</li>
                    <li>The login action is handled by the <code>LoginActionHandler</code>.</li>
                    <li>A <code>FormCredentialsExtractor</code> is used to extract the <code>LoginCredentials</code> from the request.</li>
                    <li>A <code>UserAuthenticator</code> using the user repository is used to authenticate the submitted credentials using a <code>LoginCredentialsMatcher</code> to match credentials.</li>
                    <li>The authenticator authenticates the credentials and returns a resulting <code>Authentication</code> which can be either denied (failed authentication), anonymous (no authentication) or authenticated (successful authentication). The <code>failOnDenied()</code> operator basically fails the process in case of denied authentication and no further processing is then performed, resulting in an <code>UnauthorizedException</code> being thrown.</li>
                    <li>If successful, the resulting <code>UserAuthentication</code> is mapped into a <code>JWSAuthentication</code> which basically holds a <code>JWS</code> with the authentication as payload and created using the <code>tkt</code> key previously stored in the <code>JWKStore</code>.</li>
                    <li>On successful login, a <code>CookieTokenLoginSuccessHandler</code> is used to return an <code>AUTH-TOKEN</code> cookie to the Web browser containing the JWS compact representation. The <code>RedirectLoginSuccessHandler</code> is also used to redirect the user to its original request or to <code>/</code> if the login page was directly accessed.</li>
                    <li>Finally, a <code>RedirectLoginFailureHandler</code> is used to redirect the user to the login page in case of denied authentication.</li>
                </ol>
                <p>You should also notice that the exchange context type declared in <code>WebRoutesConfigurer</code> is <code>SecurityContext&lt;PersonIdentity, AccessController&gt;</code>. Although access to the <code>SecurityContext</code> is not required by the <code>FormLoginPageHandler</code> or the <code>LoginActionHandler</code>, it is required if you want to expose a logout action using the <code>LogoutActionHandler</code> in order to be able to release the security context.</p>
                <p>Let's define a <code>/logout</code> route using the <code>LogoutActionHandler</code> to log out users:</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

...
import io.inverno.mod.security.http.form.FormAuthenticationErrorInterceptor;
import io.inverno.mod.security.http.form.RedirectLogoutSuccessHandler;
import io.inverno.mod.security.http.login.LogoutActionHandler;
import io.inverno.mod.security.http.login.LogoutSuccessHandler;
import io.inverno.mod.security.http.token.CookieTokenLogoutSuccessHandler;
import reactor.core.publisher.Mono;

@WebRoutes({
    @WebRoute(path = { "/login" }, method = { Method.GET }),
    @WebRoute(path = { "/login" }, method = { Method.POST }),
    @WebRoute(path = { "/logout" }, method = { Method.GET }, produces = { "application/json" }),
})
@Bean( visibility = Bean.Visibility.PRIVATE )
public class SecurityConfigurer implements WebRoutesConfigurer&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;&gt; {

    private final UserRepository&lt;PersonIdentity, User&lt;PersonIdentity&gt;&gt; userRepository;
    private final JWSService jwsService;

    public SecurityConfigurer(UserRepository&lt;PersonIdentity, User&lt;PersonIdentity&gt;&gt; userRepository, JWSService jwsService) {
        this.userRepository = userRepository;
        this.jwsService = jwsService;
    }

    @Override
    public void configure(WebRoutable&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;, ?&gt; routes) {
        routes
            ...
            .route()
                .path("/logout")
                .produces(MediaTypes.APPLICATION_JSON)
                .handler(new LogoutActionHandler&lt;&gt;(
                        authentication -&gt; Mono.empty(),
                        LogoutSuccessHandler.of(
                            new CookieTokenLogoutSuccessHandler&lt;&gt;(),
                            new RedirectLogoutSuccessHandler&lt;&gt;()
                        )
                ));
    }
}
</code></pre>
                <p>The above logout action basically does nothing to release the security context since the application stores its state in a JWS and is basically stateless. On successful logout, which should then always be the case, the cookie is removed by the <code>CookieTokenLogoutSuccessHandler</code> and the Web browser redirected to <code>/</code> using the <code>RedirectLogoutSuccessHandler</code>.</p>
                <p>The login page should now be all set with login and logout actions and you can move on by securing access to services and resources.</p>
                <h2 id="step-3-secure-applications-services-and-resources">Step 3: Secure applications services and resources</h2>
                <p>You should now identify the services or resources in the application that should be protected and require an authentication to access.</p>
                <p>The Ticket application basically exposes the following routes:</p>
                <ul>
                    <li><code>/</code> which points to the application welcome page.</li>
                    <li><code>/api/**</code> which points to the REST services exposed by the <code>PlanWebController</code> and the <code>TicketWebController</code>.</li>
                    <li><code>/static/**</code> which points to the static resources under <code>web_root</code> resource.</li>
                    <li><code>/webjars/**</code> which points to <a href="https://www.webjars.org">WebJars</a> resources.</li>
                    <li><code>/open-api/**</code> which points to the <a href="https://www.openapis.org">OpenAPI</a> specifications.</li>
                    <li><code>/login</code> which points to the login page.</li>
                    <li><code>/logout</code> which points to the logout action</li>
                </ul>
                <p>All these routes except the <code>/login</code> page, which must remain accessible to any user, should be protected against unauthenticated or anonymous access. In order to do that, you need to intercept requests to these routes and reject those that do do not contain valid credentials, namely the <code>AUTH-TOKEN</code> cookie containing a compact JWS normally created in the login action. In case valid credentials have been provided, a <code>SecurityContext</code> should be created and injected in the exchange context, the security context is then accessible to subsequent interceptors and route handlers.</p>
                <p>You must then modify the <code>SecurityConfigurer</code> and make it implement <code>WebInterceptorsConfigurer&lt;InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;&gt;</code> in order to configure the security interceptors on the protected routes.</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

...
import io.inverno.mod.base.reflect.Types;
import io.inverno.mod.security.http.AccessControlInterceptor;
import io.inverno.mod.security.http.SecurityInterceptor;
import io.inverno.mod.security.http.context.InterceptingSecurityContext;
import io.inverno.mod.security.http.token.CookieTokenCredentialsExtractor;
import io.inverno.mod.security.jose.jws.JWSAuthenticator;
import io.inverno.mod.web.WebInterceptable;
import io.inverno.mod.web.WebInterceptorsConfigurer;
import java.util.List;

@WebRoutes({
    @WebRoute(path = { "/login" }, method = { Method.GET }),
    @WebRoute(path = { "/login" }, method = { Method.POST }),
    @WebRoute(path = { "/logout" }, method = { Method.GET }, produces = { "application/json" }),
})
@Bean( visibility = Bean.Visibility.PRIVATE )
public class SecurityConfigurer implements WebRoutesConfigurer&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;&gt;, WebInterceptorsConfigurer&lt;InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;&gt; {

    ...
    @Override
    public void configure(WebInterceptable&lt;InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;, ?&gt; interceptors) {
        interceptors
            .intercept()                                                                                  // 1 
                .path("/")
                .path("/api/**")
                .path("/static/**")
                .path("/webjars/**")
                .path("/open-api/**")
                .path("/logout")
                .interceptors(List.of(
                    SecurityInterceptor.of(                                                               // 2 
                        new CookieTokenCredentialsExtractor(),                                            // 3 
                        new JWSAuthenticator&lt;UserAuthentication&lt;PersonIdentity&gt;&gt;(                         // 4 
                            this.jwsService, 
                            Types.type(UserAuthentication.class).type(PersonIdentity.class).and().build()
                        )  
                        .failOnDenied()                                                                   // 5 
                        .map(jwsAuthentication -&gt; jwsAuthentication.getJws().getPayload())                // 6 
                    ),
                    AccessControlInterceptor.authenticated()                                              // 7 
                ));
    }
}
</code></pre>
                <ol>
                    <li>All routes except the <code>/login</code> route are intercepted.</li>
                    <li>The <code>SecurityInterceptor</code> which is the main security interceptor responsible for authenticating credentials and creating the security context is declared first.</li>
                    <li>It uses a <code>CookieTokenCredentialsExtractor</code> to extract <code>TokenCredentials</code> from the <code>AUTH-TOKEN</code> cookie in the request.</li>
                    <li>A <code>JWSAuthenticator</code> backed by the <code>JWSService</code> is then used to parse and verify the compact JWS token which should wrap the original <code>UserAuthentication&lt;PersonIdentity&gt;</code> that was created when authenticating the user credentials in the login action. Note that the type of the JWS payload must be specified explicitly for the underlying <code>ObjectMapper</code> to decode it (and also to benefit from static checking).</li>
                    <li>The <code>failOnDenied()</code> operator is used to stop the processing if the resulting <code>JWSAuthentication</code> was denied either because the token was invalid (e.g. not a JWS or bad signature) or because the wrapped authentication is actually denied (which should never happen since a token is only generated on successful login credentials authentication), resulting in an <code>UnauthorizedException</code> being thrown.</li>
                    <li>The original <code>UserAuthentication&lt;PersonIdentity&gt;</code> is then unwrapped, the security interceptor then creates a <code>SecurityContext</code> with the original authentication instead of the <code>JWSAuthentication</code>.</li>
                    <li>Finally, we make sure only authenticated security context can access the protected service or resource. This basically means that only users that provided valid login credentials have access to the application.</li>
                </ol>
                <p>Note that the exchange context type declated in the <code>WebInterceptorsConfigurer</code> is <code>InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;</code>, the <code>InterceptingSecurityContext</code> is required by the <code>SecurityInterceptor</code> in order to populate the <code>SecurityContext</code>.</p>
                <p>Using a <code>JWS</code> token has many advantages: first it is easy to verify that the provided credentials are valid by verifying the digital signature using <code>tkt</code> key and then, the original <code>UserAuthentication&lt;PersonIdentity&gt;</code> could have been restored. It provides user's identity and roles that can then be used directly to get the user's <code>PersonIdentity</code> or obtain a <code>RoleBasedAccessController</code> without having to query the user repository again.</p>
                <blockquote>
                    <p>Keep in mind that this is a basic use case that might not be secured enough as JWS tokens thus created never expire which should be seen as a security issue in most systems. It should then be wise to consider using a <a href="https://datatracker.ietf.org/doc/html/rfc7519">JSON Web Token</a> which supports expiry or implement such expiration mechanism explicitly.</p>
                </blockquote>
                <p>It should now be impossible to access a protected resource without being authenticated, however a user won't be automatically redirected to the login page when receiving an unauthorized (401) error. This can be done by intercepting <code>UnauthorizedException</code> in the error router.</p>
                <p>You must then modify the <code>SecurityConfigurer</code> one more time to make it implement <code>ErrorWebRouterConfigurer&lt;ExchangeContext&gt;</code> in order to intercept unauthorized errors and use a <code>FormAuthenticationErrorInterceptor</code> to redirect the user to the login page:</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

...
import io.inverno.mod.http.base.UnauthorizedException;
import io.inverno.mod.http.server.ExchangeContext;
import io.inverno.mod.web.ErrorWebRouter;
import io.inverno.mod.web.ErrorWebRouterConfigurer;

@WebRoutes({
    @WebRoute(path = { "/login" }, method = { Method.GET }),
    @WebRoute(path = { "/login" }, method = { Method.POST }),
    @WebRoute(path = { "/logout" }, method = { Method.GET }, produces = { "application/json" }),
})
@Bean( visibility = Bean.Visibility.PRIVATE )
public class SecurityConfigurer implements WebRoutesConfigurer&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;&gt;, WebInterceptorsConfigurer&lt;InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;&gt;, ErrorWebRouterConfigurer&lt;ExchangeContext&gt; {

    ...
    @Override
    public void configure(ErrorWebRouter&lt;ExchangeContext&gt; errorRouter) {
        errorRouter
            .intercept()
            .path("/")
            .error(UnauthorizedException.class)
            .interceptor(new FormAuthenticationErrorInterceptor&lt;&gt;())
            .applyInterceptors(); // We must apply interceptors to intercept white labels error routes which are already defined
    }
}
</code></pre>
                <p>The Inverno Ticket application is a single page application, so this redirection can be limited to the welcome page <code>/</code>, accessing any other resources will simply result in an authorized (401) response.</p>
                <p>The Ticket application should now be properly secured and only authenticated users shall be allowed to access the application.</p>
                <h2 id="step-4-expose-the-users-identity">Step 4: Expose the user's identity</h2>
                <p>You might now want to display the user's identity in the application UI. To do so you need to expose the identity on the server.</p>
                <p>But first you must resolve the user's identity from the <code>UserAuthentication</code>, this can be done easily by adding a <code>UserIdentityResolver</code> to the <code>SecurityInterceptor</code>:</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

...
import io.inverno.mod.security.identity.UserIdentityResolver;

@WebRoutes({
    @WebRoute(path = { "/login" }, method = { Method.GET }),
    @WebRoute(path = { "/login" }, method = { Method.POST }),
    @WebRoute(path = { "/logout" }, method = { Method.GET }, produces = { "application/json" }),
})
@Bean( visibility = Bean.Visibility.PRIVATE )
public class SecurityConfigurer implements WebRoutesConfigurer&lt;SecurityContext&lt;PersonIdentity, AccessController&gt;&gt;, WebInterceptorsConfigurer&lt;InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;&gt;, ErrorWebRouterConfigurer&lt;ExchangeContext&gt; {

    ...
    @Override
    public void configure(WebInterceptable&lt;InterceptingSecurityContext&lt;PersonIdentity, AccessController&gt;, ?&gt; interceptors) {
        interceptors
            .intercept()
                .path("/")
                .path("/api/**")
                .path("/static/**")
                .path("/webjars/**")
                .path("/open-api/**")
                .path("/logout")
                .interceptors(List.of(
                    SecurityInterceptor.of(
                        new CookieTokenCredentialsExtractor(),
                        new JWSAuthenticator&lt;UserAuthentication&lt;PersonIdentity&gt;&gt;(
                            this.jwsService,
                            Types.type(UserAuthentication.class).type(PersonIdentity.class).and().build()
                        )
                        .failOnDenied()
                        .map(jwsAuthentication -&gt; jwsAuthentication.getJws().getPayload()),
                        new UserIdentityResolver&lt;&gt;()
                    ),
                    AccessControlInterceptor.authenticated()
                ));
    }
}
</code></pre>
                <blockquote>
                    <p>Here the user's identity is resolved for all routes but it is also possible to resolve it only for the routes that need it, simply by defining different security interceptors.</p>
                </blockquote>
                <p>The user's identity should now be accessible from the <code>SecurityContext</code> in the exchange, you can then create the following <code>SecurityController</code> to expose the user's identity to the UI:</p>
                <pre><code class="language-java">package io.inverno.app.ticket.internal.security;

import io.inverno.core.annotation.Bean;
import io.inverno.mod.base.resource.MediaTypes;
import io.inverno.mod.http.base.Method;
import io.inverno.mod.security.accesscontrol.AccessController;
import io.inverno.mod.security.http.context.SecurityContext;
import io.inverno.mod.security.identity.Identity;
import io.inverno.mod.web.annotation.WebController;
import io.inverno.mod.web.annotation.WebRoute;

@Bean( visibility = Bean.Visibility.PRIVATE )
@WebController( path = "/api/security" )
public class SecurityController {

    @WebRoute( path = "/identity", method = Method.GET, produces = MediaTypes.APPLICATION_JSON )
    public Identity identity(SecurityContext&lt;? extends Identity, ? extends AccessController&gt; securityContext) {
        return securityContext.getIdentity().get();
    }
}
</code></pre>
                <p>User's identity is now exposed at <a href="http://localhost:8080/api/security/identity">http://localhost:8080/api/security/identity</a>. The UI can also be modified to display the user's identity.</p>
                <blockquote>
                    <p>One might say that the JWS token actually contains user's identity information and that there is then no need to expose them on the server, however an <code>AUTH-TOKEN</code> cookie must be HTTP only and therefore cannot be read from the UI.</p>
                </blockquote>
                <h2 id="step-5-run-the-application">Step 5: Run the application</h2>
                <p>Before you can run the application, you need to define a user in the Redis user repository. Although it is possible to do this by creating an entry in the Redis data store using a simple Redis client, it is easier and safer to rely on the <code>UserRepository</code> to do this.</p>
                <p>So let's modify the <code>TicketApp#main()</code> method and use the <code>UserRepository</code> bean to create user <code>jsmith</code> if it does not already exist when the application is starting:</p>
                <pre><code class="language-java">package io.inverno.app.ticket;

import io.inverno.core.annotation.Bean;
import io.inverno.core.v1.Application;
import io.inverno.mod.configuration.ConfigurationKey;
import io.inverno.mod.configuration.ConfigurationProperty;
import io.inverno.mod.configuration.ConfigurationSource;
import io.inverno.mod.configuration.source.BootstrapConfigurationSource;
import io.inverno.mod.security.authentication.password.RawPassword;
import io.inverno.mod.security.authentication.user.User;
import io.inverno.mod.security.identity.PersonIdentity;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import reactor.core.publisher.Mono;
import java.io.IOException;
import java.util.List;
import java.util.function.Supplier;

public class TicketApp {

    ...
    public static void main(String[] args) throws IOException {
        final BootstrapConfigurationSource bootstrapConfigurationSource = new BootstrapConfigurationSource(TicketApp.class.getModule(), args);
        Ticket ticketApp = bootstrapConfigurationSource
            ...

        ticketApp.userRepository().getUser("jsmith")
            .switchIfEmpty(Mono.defer(() -&gt; ticketApp.userRepository().createUser(User.of("jsmith")
                .password(new RawPassword("password"))
                .identity(new PersonIdentity("jsmith", "John", "Smith", "jsmith@inverno.io"))
                .build())
            ))
            .block();
    }
}
</code></pre>
                <p>You might have noticed that the password is specified in clear text as a <code>RawPassword</code>, but it is actually stored securely in the Redis data store using <a href="https://en.wikipedia.org/wiki/PBKDF2">Password-Based Key Derivation Function 2</a> by default. This can be changed by defining a different password encoder in the <code>RedisUserRepository</code>.</p>
                <blockquote>
                    <p>The user repository can also be exposed in a Web controller in order easily manage users from the application UI.</p>
                </blockquote>
                <p>You should now be able to run the application using <a href="https://docs.docker.com/compose/">Docker Compose</a> as described in the <a href="../../../docs/redis-vue3-fullstack/html/index.html">full-stack application Guide</a> or directly using <a href="https://www.docker.com">Docker</a> to start a Redis datastore and the Inverno Maven plugin to run the application.</p>
                <pre><code class="language-plaintext">$ docker run -d -p6379:6379 redis
</code></pre>
                <pre><code class="language-plaintext">$ mvn inverno:run
...
[INFO] --- inverno-maven-plugin:1.4.0:run (default-cli) @ inverno-ticket ---
[INFO] Running project: io.inverno.app.ticket@1.2.0-SNAPSHOT...
 [â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• 100&nbsp;% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•] 
2022-08-10 16:15:39,961 INFO  [main] i.i.a.t.TicketApp - Active profile: default
2022-08-10 16:15:40,075 INFO  [main] i.i.c.v.Application - Inverno is starting...


     â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
     â•‘                      , ~~ ,                                                                â•‘
     â•‘                  , '   /\   ' ,                                                            â•‘
     â•‘                 , __   \/   __ ,      _                                                    â•‘
     â•‘                ,  \_\_\/\/_/_/  ,    | |  ___  _    _  ___   __  ___   ___                 â•‘
     â•‘                ,    _\_\/_/_    ,    | | / _ \\ \  / // _ \ / _|/ _ \ / _ \                â•‘
     â•‘                ,   __\_/\_\__   ,    | || | | |\ \/ /|  __/| | | | | | |_| |               â•‘
     â•‘                 , /_/ /\/\ \_\ ,     |_||_| |_| \__/  \___||_| |_| |_|\___/                â•‘
     â•‘                  ,     /\     ,                                                            â•‘
     â•‘                    ,   \/   ,                                 -- 1.5.3 --                  â•‘
     â•‘                      ' -- '                                                                â•‘
     â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
     â•‘ Java runtime        : OpenJDK Runtime Environment                                          â•‘
     â•‘ Java version        : 17.0.2+8-86                                                          â•‘
     â•‘ Java home           : /home/jkuhn/Devel/jdk/jdk-17.0.2                                     â•‘
     â•‘                                                                                            â•‘
     â•‘ Application module  : io.inverno.app.ticket                                                â•‘
     â•‘ Application version : 1.2.0-SNAPSHOT                                                       â•‘
     â•‘ Application class   : io.inverno.app.ticket.TicketApp                                      â•‘
     â•‘                                                                                            â•‘
     â•‘ Modules             :                                                                      â•‘
     â•‘  * ...                                                                                     â•‘
     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


2022-08-10 16:15:40,080 INFO  [main] i.i.a.t.Ticket - Starting Module io.inverno.app.ticket...
2022-08-10 16:15:40,081 INFO  [main] i.i.m.b.Boot - Starting Module io.inverno.mod.boot...
2022-08-10 16:15:40,342 INFO  [main] i.i.m.b.Boot - Module io.inverno.mod.boot started in 261ms
2022-08-10 16:15:40,342 INFO  [main] i.i.m.r.l.Lettuce - Starting Module io.inverno.mod.redis.lettuce...
2022-08-10 16:15:40,404 INFO  [main] i.i.m.r.l.Lettuce - Module io.inverno.mod.redis.lettuce started in 61ms
2022-08-10 16:15:40,405 INFO  [main] i.i.m.s.j.Jose - Starting Module io.inverno.mod.security.jose...
2022-08-10 16:15:40,490 INFO  [main] i.i.m.s.j.Jose - Module io.inverno.mod.security.jose started in 85ms
2022-08-10 16:15:40,490 INFO  [main] i.i.m.w.Web - Starting Module io.inverno.mod.web...
2022-08-10 16:15:40,491 INFO  [main] i.i.m.h.s.Server - Starting Module io.inverno.mod.http.server...
2022-08-10 16:15:40,491 INFO  [main] i.i.m.h.b.Base - Starting Module io.inverno.mod.http.base...
2022-08-10 16:15:40,496 INFO  [main] i.i.m.h.b.Base - Module io.inverno.mod.http.base started in 5ms
2022-08-10 16:15:40,701 INFO  [main] i.i.m.h.s.i.HttpServer - HTTP Server (epoll) listening on http://0.0.0.0:8080
2022-08-10 16:15:40,701 INFO  [main] i.i.m.h.s.Server - Module io.inverno.mod.http.server started in 210ms
2022-08-10 16:15:40,702 INFO  [main] i.i.m.w.Web - Module io.inverno.mod.web started in 211ms
2022-08-10 16:15:40,707 INFO  [main] i.i.a.t.Ticket - Module io.inverno.app.ticket started in 627ms
2022-08-10 16:15:40,708 INFO  [main] i.i.c.v.Application - Application io.inverno.app.ticket started in 739ms
</code></pre>
                <p>Now if you try to access to the application by opening <a href="http://localhost:8080">http://localhost:8080</a> in your Web browser, you should be automatically redirected to the login page:</p> <img class="img-fluid shadow" src="img/inverno_login_page.png" style="display: block; margin: 2em auto;" alt="Inverno Login page" />
                <p>In order to access the application, you must enter valid login credentials, for instance <code>jsmith/password</code>, you should get redirected to the original request <code>/</code> and user's identity should be displayed in the UI:</p> <img class="img-fluid shadow" src="img/inverno_ticket_authenticated.png" style="display: block; margin: 2em auto;" alt="Inverno Ticket application" />
                <p>Once authenticated the user's identity can be retrieved by requesting <a href="http://localhost:8080/api/security/identity">http://localhost:8080/api/security/identity</a>:</p>
                <pre><code class="language-plaintext">$ curl -i -H "cookie: AUTH-TOKEN=eyJhbGciOiJIUzUxMiIsImtpZCI6InRrdCJ9.eyJpZGVudGl0eSI6eyJAYyI6Ii5QZXJzb25JZGVudGl0eSIsInVpZCI6ImpzbWl0aCIsImZpcnN0TmFtZSI6IkpvaG4iLCJsYXN0TmFtZSI6IlNtaXRoIiwiZW1haWwiOiJqc21pdGhAaW52ZXJuby5pbyJ9LCJ1c2VybmFtZSI6ImpzbWl0aCIsImF1dGhlbnRpY2F0ZWQiOnRydWUsImFub255bW91cyI6ZmFsc2UsImdyb3VwcyI6W119.mz2ez72LFj-m9flJ181kczlUgyTvDhJc64s4vfyKy8_6DHDSkMFp5jo_C3eydrOM-o3hwvA8IjCdGaK2P9ZAOw" http://localhost:8080/api/security/identity
HTTP/1.1 200 OK
content-type: application/json
content-length: 105

{"@c":".PersonIdentity","uid":"jsmith","firstName":"John","lastName":"Smith","email":"jsmith@inverno.io"}
</code></pre>
                <p>Congratulations! You've just secured access to an Inverno Web application using a form-based login and JSON Web signature tokens.</p>
            </section>
        </main>
        <footer class="footer bg-light border-top mt-5">
            <div class="container p-5">
                <div class="row mb-5">
                    <div class="col col-lg-3">
                        <h5>Documentation</h5>
                        <ul class="nav flex-column">
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/release/reference/html/index.html">Reference</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/release/api/index.html">API Doc</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/getting-started/html/index.html">Getting Started</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/redis-vue3-fullstack/html/index.html">Build a Full-Stack application</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/security-form-jws/html/index.html">Secure a Web application</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/security-rbac/html/index.html">Role-based Access Control</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/security-pbac/html/index.html">Permission-based Access Control</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="../../../docs/security-ldap/html/index.html">LDAP Security</a></li>
                        </ul>
                    </div>
                    <div class="col col-lg-3">
                        <h5>Projects</h5>
                        <ul class="nav flex-column">
                            <li class="nav-item"><a class="nav-link px-0" href="https://github.com/inverno-io/inverno-core">Core</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="https://github.com/inverno-io/inverno-mods">Modules</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="https://github.com/inverno-io/inverno-dist">Distribution</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="https://github.com/inverno-io/inverno-tools">Tools</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="https://github.com/inverno-io/inverno-examples">Examples</a></li>
                            <li class="nav-item"><a class="nav-link px-0" href="https://github.com/inverno-io/inverno-apps">Apps</a></li>
                        </ul>
                    </div>
                    <div class="col d-none d-lg-block"><iframe src="https://github.com/sponsors/inverno-io/card" title="Sponsor inverno-io" height="225" width="600" style="border: 0;"></iframe>
                    </div>
                </div>
            </div>
            <div class="p-3 mb-5 text-center">
                <p class="fw-light fs-6">The Inverno Framework is released under version 2.0 of the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License</a>.</p>
                <p class="fw-light fs-6">Copyright Â© 2024, The Inverno Framework</p>
            </div>
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>
    </body>
</html>